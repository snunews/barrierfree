<html>
<head>
    <meta charset="utf-8">
    <title>배리어프리지도</title>
    <style>
        .wrap {position: absolute;left: 0;bottom: 40px;width: 288px;height: 132px;margin-left: -144px;text-align: left;overflow: hidden;font-size: 12px;font-family: 'Malgun Gothic', dotum, '돋움', sans-serif;line-height: 1.5;}
        .wrap * {padding: 0;margin: 0;}
        .wrap .info {width: 286px;height: 120px;border-radius: 5px;border-bottom: 2px solid #ccc;border-right: 1px solid #ccc;overflow: hidden;background: #fff;}
        .wrap .info:nth-child(1) {border: 0;box-shadow: 0px 1px 2px #888;}
        .info .title {padding: 5px 0 0 10px;height: 30px;background: #eee;border-bottom: 1px solid #ddd;font-size: 18px;font-weight: bold;}
        .info .body {position: relative;overflow: hidden;}
        .info .desc {position: relative;margin: 13px 0 0 90px;height: 75px;}
        .desc .ellipsis {overflow: hidden;text-overflow: ellipsis;white-space: nowrap;}
        .desc .jibun {font-size: 11px;color: #888;margin-top: -2px;}
        .info .img {position: absolute;top: 6px;left: 5px;width: 73px;height: 71px;border: 1px solid #ddd;color: #888;overflow: hidden;}
        .info:after {content: '';position: absolute;margin-left: -12px;left: 50%;bottom: 0;width: 22px;height: 12px;background: url('./box.png')}
    </style>
</head>

<body>
<div id="map" style="width:100%;height:100%;"></div>
<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=eaacd85667b547236237eafb8ba8244a"></script>
<script>
    var mapContainer = document.getElementById('map'), // 지도를 표시할 div
        mapOption = {
            center: new kakao.maps.LatLng(37.459494, 126.952222), // 지도의 중심좌표
            level: 5 // 지도의 확대 레벨
        };
    // 지도 생성
    var map = new kakao.maps.Map(mapContainer, mapOption);

    // 줌 컨트롤
    var zoomControl = new kakao.maps.ZoomControl();
    map.addControl(zoomControl, kakao.maps.ControlPosition.RIGHT)

    // 마커 선택지
    var bad ='./bad.png',
        good = './good.png',
        soso ='./soso.png';

    //마커커스텀
    var imageSize = new kakao.maps.Size(60, 60),
        imageOption = {offset: new kakao.maps.Point(27, 69)};

    //장소 목록
    var places =[
        {
            title: '중앙도서관',
            section: '화장실',
            probelm : '문이 무거움',
            latlng: new kakao.maps.LatLng(37.45943775683825, 126.95214618421608),
            what: bad
        },
        {
            title: '사범대 11동',
            section :'출입구',
            problem : '경사로에 손잡이 없음',
            latlng: new kakao.maps.LatLng(37.45971766987394, 126.95474709650235),
            what: good
        }
    ];

    // 반복문 걸기
    for(let i=0; i < places.length; i++){
        var data = places[i];
        displayMarker(data);}

    // 마커와 오버레이
    function displayMarker(data) {
        //마커
        var MarkerImage = new kakao.maps.MarkerImage(data.what, imageSize, imageOption),
            marker = new kakao.maps.Marker({map: map,
                position: data.latlng,
                image: MarkerImage
            });

        //콘텐츠
        var content = '<div class="wrap">' +
            '<div class="info">' +
            '<div class="title">' + data.title +'</div>' +
            '<div class="body">' +
            '<div class="img">' +
            '<img src="https://cfile181.uf.daum.net/image/250649365602043421936D" width="73" height="70">' +
            '</div>' +
            '<div class="desc">' +
            '<div class="ellipsis">'+ data.section +'</div>' +
            '<div class="jibun ellipsis">'+data.problem +'</div>' +
            '</div>' +
            '</div>' +
            '</div>' +
            '</div>';
        
        //오버레이
        var overlay = new kakao.maps.CustomOverlay({content: content,
            yAnchor: 3,
            map: map,
            position: marker.getPosition()
        });

        var closeBtn = document.createElement('button');
        closeBtn.innerHTML = '닫기';
        closeBtn.onclick = function () {
            overlay.setMap(null);
        };
        content.appendChild(closeBtn);
        overlay.setContent(content);

        //오버레이 열리게 하기
        kakao.maps.event.addListener(marker, 'click', function() {overlay.setMap(map);
        });

    }
</script>
</body>
</html>
