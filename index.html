<html>
<head>
    <meta charset="utf-8">
    <title>배리어프리지도</title>
    <style>
    </style>
</head>

<body>
<div id="map" style="width:100%;height:500px;"></div>
<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=eaacd85667b547236237eafb8ba8244a"></script>
<script>
    var mapContainer = document.getElementById('map'), // 지도를 표시할 div
        mapOption = {
            center: new kakao.maps.LatLng(37.459494, 126.952222), // 지도의 중심좌표
            level: 3 // 지도의 확대 레벨
        };
    // 지도 생성
    var map = new kakao.maps.Map(mapContainer, mapOption);

    // 줌 컨트롤
    var zoomControl = new kakao.maps.ZoomControl();
    map.addControl(zoomControl, kakao.maps.ControlPosition.RIGHT)

    // 마커 선택지
    var bad ='./bad.png',
        good = './good.png',
        soso ='./soso.png';

    //마커커스텀
    var imageSize = new kakao.maps.Size(60, 60),
        imageOption = {offset: new kakao.maps.Point(27, 69)};

    //장소 목록
    var places =[
        {
            title: '중앙도서관',
            section: '화장실',
            probelm : '문이 무거움',
            latlng: new kakao.maps.LatLng(37.45943775683825, 126.95214618421608),
            what: bad
        },
        {
            title: '사범대 11동',
            section :'출입구',
            problem : '경사로에 손잡이 없음',
            latlng: new kakao.maps.LatLng(37.45971766987394, 126.95474709650235),
            what: good
        }
    ];

    // 반복문 걸기
    for(let i=0; i < places.length; i++){
        var data = places[i];
        displayMarker(data);}

    // 마커와 오버레이
    function displayMarker(data) {
        //마커
        var MarkerImage = new kakao.maps.MarkerImage(data.what, imageSize, imageOption),
            marker = new kakao.maps.Marker({map: map,
                                            position: data.latlng,
                                            image: MarkerImage
                                           });
        
        //오버레이
        var overlay = new kakao.maps.CustomOverlay({content: content,
                                                    yAnchor: 3
                                                    map: map,
                                                    position: marker.getPosition()
                                                    });
        
        //콘텐츠
        var content = document.createElement('div');
        content.innerHTML =  data.title;
        content.style.cssText = 'background: white; ;
        
        var closeBtn = document.createElement('button');
        closeBtn.innerHTML = '닫기';
        closeBtn.onclick = function () {
        overlay.setMap(null);
        };
        content.appendChild(closeBtn);
        overlay.setContent(content);
        
        //오버레이 열리게 하기
        kakao.maps.event.addListener(marker, 'click', function() {overlay.setMap(map);
        });
        
    }
</script>
</body>
</html>
